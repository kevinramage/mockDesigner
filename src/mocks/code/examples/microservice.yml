name: MicroServices
services:


# Get commands
- name: GetAllCommands
  method: GET
  path: /api/v1/command
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: getall
        storage: command

# Get a command
- name: GetCommand
  method: GET
  path: /api/v1/command/:cmdId
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: get
        storage: command
        keys:
        - "{{.request.params.cmdId}}"

# Create a command
- name: CreateCommand
  method: POST
  path: /api/v1/command
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: create
        storage: command
        identifier: 
          name: id
          value: "{{Increment(commandCounter)}}"

# Update a command
- name: UpdateCommand
  method: PUT
  path: /api/v1/command/:cmdId
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: update
        storage: command
        keys: 
        - "{{.request.params.cmdId}}"

# Delete a command
- name: DeleteCommand
  method: DELETE
  path: /api/v1/command/:cmdId
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: delete
        storage: command
        keys: 
        - "{{.request.params.cmdId}}"

# Get products
- name: GetAllProducts
  method: GET
  path: /api/v1/command/:cmdId/product
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: getall
        storage: product
        keys:
        - "{{.request.params.cmdId}}"

# Get a product
- name: GetProduct
  method: GET
  path: /api/v1/command/:cmdId/product/:prdId
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: get
        storage: product
        keys:
        - "{{.request.params.cmdId}}"
        - "{{.request.params.prdId}}"

# Create a product
- name: CreateProduct
  method: POST
  path: /api/v1/command/:cmdId/product
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: create
        storage: product
        identifier: 
          name: id
          value: "{{Increment(command{{.request.params.cmdId}}, productCounter)}}"
        keys: 
        - "{{.request.params.cmdId}}"

# Update a product
- name: UpdateProduct
  method: PUT
  path: /api/v1/command/:cmdId/product/:prdId
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: update
        storage: product
        identifier: 
          name: id
          value: "{{Increment({{.request.params.cmdId}}, productCounter)}}"
        keys: 
        - "{{.request.params.cmdId}}"
        - "{{.request.params.prdId}}"

- name: DeleteProduct
  method: DELETE
  path: /api/v1/command/:cmdId/product/:prdId
  response:
    triggers:
    - type: none
      actions:
      - type: microservice
        action: delete
        storage: product
        keys: 
        - "{{.request.params.cmdId}}"
        - "{{.request.params.prdId}}"